// Generated by CoffeeScript 1.6.1
(function() {
  var define, log, root;

  root = this;

  log = root.log;

  define = root.define;

  define(['jquery', 'input/actor-announcer-character', 'touchable/draggable-number'], function($, ActorAnnouncerCharacter, DraggableNumber) {
    var ActorAnnouncerSinger,
      _this = this;
    ActorAnnouncerSinger = (function() {

      function ActorAnnouncerSinger() {
        var _this = this;
        this.onInputSingers = function(event) {
          return ActorAnnouncerSinger.prototype.onInputSingers.apply(_this, arguments);
        };
        this.onInputActors = function(event) {
          return ActorAnnouncerSinger.prototype.onInputActors.apply(_this, arguments);
        };
        this.html = "<fieldset>\n	I'll need\n	<input type=\"number\" name=\"num-actors\" id=\"num-actors\" value=\"0\" min=\"0\" max=\"10\">\n	<a href=\"#actor-announcer\" class=\"term open\">actor/announcer</a>(s) and\n	<input type=\"number\" name=\"num-singers\" id=\"num-singers\" value=\"0\" min=\"0\" max=\"2\">\n	<a href=\"#singer\" class=\"term open\">singer</a>(s).\n	<span style=\"display: none;\" id=\"more-singers\">\n		Looking for more singers?\n		<a href=\"mailto:togren@sagaftra.org?subject=SAG-AFTRAnumbers%20Question\">Contact Tim at SAG-AFTRA</a>!\n	</span>\n</fieldset>";
        this.$el = $(this.html);
        this.el = this.$el[0];
        this.actors = [];
        this.$el.on('input change', '#num-actors', this.onInputActors);
        this.$el.on('input change', '#num-singers', this.onInputSingers);
      }

      ActorAnnouncerSinger.prototype.onInputActors = function(event) {
        var actor, numActors;
        numActors = parseInt(event.target.value, 10);
        if (numActors === this.actors.length) {
          return;
        }
        if (numActors > this.actors.length) {
          while (this.actors.length < numActors) {
            actor = new ActorAnnouncerCharacter(this.actors.length + 1);
            this.actors.push(actor);
            this.$el.appendPolyfill(actor.$el);
          }
        } else {
          while (this.actors.length > numActors) {
            this.actors.pop().$el.remove();
          }
        }
        if (event.type === 'input') {
          return this.$el.trigger('change');
        }
      };

      ActorAnnouncerSinger.prototype.onInputSingers = function(event) {
        if (event.target.value === $(event.target).attr('max')) {
          this.$el.find('#more-singers').filter(":hidden").show();
        } else {
          this.$el.find('#more-singers').filter(":visible").hide();
        }
        if (event.type === 'input') {
          return this.$el.trigger('change');
        }
      };

      return ActorAnnouncerSinger;

    })();
    return ActorAnnouncerSinger;
  });

}).call(this);
